﻿<style type="text/css">
     .card {
         width: 60%;
         margin-left: 20%;
         margin-top: 5%
     }
</style>

<div class="card">
    <div class="card-header">
        <h2>Edit User</h2>
    </div>
    <div class="card-body">

        <div class="row">
            <div class="col-lg-12">
                <div class="form-group">
                    <label>ID</label>
                    <input disabled="disabled" value="@ViewData["editcode"]" class="form-control" id="txtcode" />
                </div>
            </div>
            <div class="col-lg-12">
                <div class="form-group">
                    <label>Name</label>
                    <input class="form-control" id="txtname" />
                </div>
            </div>
            <div class="col-lg-12">
                <div class="form-group">
                    <label>Email</label>
                    <input class="form-control" id="txtemail" />
                </div>
            </div>
            <div class="col-lg-12">
                <div class="form-group">
                    <label>
                        Phone Number
                    </label>
                    <input class="form-control" id="txtphone" />
                </div>
            </div>
            <div class="col-lg-12">
                <div class="form-group">
                    <label>
                        Skillset
                    </label>
                    <input class="form-control" id="txtskillset" />
                </div>
            </div>
            <div class="col-lg-12">
                <div class="form-group">
                    <label>
                        Hobby
                    </label>
                    <input class="form-control" id="txthobby" />
                </div>
            </div>
        </div>
    </div>
    <div class="card-footer">
        <a onclick="SaveCustomer()" class="btn btn-primary">Save</a>
        <a asp-controller="User" asp-action="Index" class="btn btn-danger">Back</a>
    </div>


</div>
<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script type="text/javascript">

    $(document).ready(function () {
        var code = $('#txtcode').val();
        if (code != '' && code != null) {
            $.ajax({
                type: 'GET',
                url: 'https://localhost:7285/api/User/Get/' + code,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                async: false,
                success: function (data) {
                    if (data != null) {
                        $('#txtname').val(data.userName);
                        $('#txtemail').val(data.mail);
                        $('#txtphone').val(data.phoneNumber);
                        $('#txtskillset').val(data.skillSet);
                        $('#txthobby').val(data.hobby);            
                    }
                },
                failure: function (error) {
                    console.log("not saved");
                }
            })
        }
    })

    

    function SaveCustomer() 
    {
        var isproceed = true;
        var _code = $('#txtcode');
        var _name = $('#txtname');
        var _email = $('#txtemail');
        var _phone = $('#txtphone');
        var _skillset = $('#txtskillset');
        var _hobby = $('#txthobby');
        var code = parseInt(_code.val());
        var name = _name.val();
        var email = _email.val();
        var phone = _phone.val();
        var skillset = _skillset.val();
        var hobby = _hobby.val();
        if (name == null || name == '') {
            _name.css('border-color', 'red');
            isproceed = false;
        } else {
            _name.css('border-color', '#ccc');
        }
        if (isproceed) {

            var _obj = new Object();

            _obj.code = code;
            _obj.userName = name;
            _obj.mail = email;
            _obj.phoneNumber = phone;
            _obj.skillSet = skillset;
            _obj.hobby = hobby;

            $.ajax({ 
                url: 'https://localhost:7285/api/User/Put/' + code,
                type: 'PUT',
                contentType: 'application/json',
                data: JSON.stringify(_obj),
                success: function (data) {
                    console.log(data);
                    alert('Saved Successfully.');
                },
                error: function (error) {
                    // console.error('Error:', error.responseText);
                    alert('fail data save');
                }
            });
        }
    }
</script>